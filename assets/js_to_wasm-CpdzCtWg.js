(function(){"use strict";let c,d=null;function h(){return(d===null||d.byteLength===0)&&(d=new Uint8Array(c.memory.buffer)),d}let m=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&m.decode();const S=2146435072;let E=0;function I(t,e){return E+=e,E>=S&&(m=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}},m.decode(),E=e),m.decode(h().subarray(t,t+e))}function w(t,e){return t=t>>>0,I(t,e)}function l(t){const e=c.__externref_table_alloc();return c.__wbindgen_export_2.set(e,t),e}function b(t,e){try{return t.apply(this,e)}catch(n){const r=l(n);c.__wbindgen_exn_store(r)}}let y=0;const x=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},j=typeof x.encodeInto=="function"?function(t,e){return x.encodeInto(t,e)}:function(t,e){const n=x.encode(t);return e.set(n),{read:t.length,written:n.length}};function A(t,e,n){if(n===void 0){const s=x.encode(t),a=e(s.length,1)>>>0;return h().subarray(a,a+s.length).set(s),y=s.length,a}let r=t.length,o=e(r,1)>>>0;const _=h();let i=0;for(;i<r;i++){const s=t.charCodeAt(i);if(s>127)break;_[o+i]=s}if(i!==r){i!==0&&(t=t.slice(i)),o=n(o,r,r=i+t.length*3,1)>>>0;const s=h().subarray(o+i,o+r),a=j(t,s);i+=a.written,o=n(o,r,i,1)>>>0}return y=i,o}let g=null;function u(){return(g===null||g.buffer.detached===!0||g.buffer.detached===void 0&&g.buffer!==c.memory.buffer)&&(g=new DataView(c.memory.buffer)),g}function f(t){return t==null}function T(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const o=t.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=t.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(t)){const o=t.length;let _="[";o>0&&(_+=T(t[0]));for(let i=1;i<o;i++)_+=", "+T(t[i]);return _+="]",_}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n&&n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function C(t){return c.chance_to_cost_wrapper(t)}function D(t){return c.cost_to_chance_wrapper(t)}function O(t){return c.parser_wrapper(t)}function W(t){return c.parser_wrapper_unified(t)}const R=new Set(["basic","cors","default"]);async function B(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.ok&&R.has(t.type)&&t.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function L(){const t={};return t.wbg={},t.wbg.__wbg_Error_0497d5bdba9362e5=function(e,n){return Error(w(e,n))},t.wbg.__wbg_buffer_a1a27a0dfa70165d=function(e){return e.buffer},t.wbg.__wbg_call_f2db6205e5c51dc8=function(){return b(function(e,n,r){return e.call(n,r)},arguments)},t.wbg.__wbg_call_fbe8be8bf6436ce5=function(){return b(function(e,n){return e.call(n)},arguments)},t.wbg.__wbg_crypto_574e78ad8b13b65f=function(e){return e.crypto},t.wbg.__wbg_done_4d01f352bade43b7=function(e){return e.done},t.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,n){let r,o;try{r=e,o=n,console.error(w(e,n))}finally{c.__wbindgen_free(r,o,1)}},t.wbg.__wbg_getRandomValues_b8f5dbd5f3995a9e=function(){return b(function(e,n){e.getRandomValues(n)},arguments)},t.wbg.__wbg_get_92470be87867c2e5=function(){return b(function(e,n){return Reflect.get(e,n)},arguments)},t.wbg.__wbg_get_a131a44bd1eb6979=function(e,n){return e[n>>>0]},t.wbg.__wbg_getwithrefkey_1dc361bd10053bfe=function(e,n){return e[n]},t.wbg.__wbg_instanceof_ArrayBuffer_a8b6f580b363f2bc=function(e){let n;try{n=e instanceof ArrayBuffer}catch{n=!1}return n},t.wbg.__wbg_instanceof_Uint8Array_ca460677bc155827=function(e){let n;try{n=e instanceof Uint8Array}catch{n=!1}return n},t.wbg.__wbg_isArray_5f090bed72bd4f89=function(e){return Array.isArray(e)},t.wbg.__wbg_isSafeInteger_90d7c4674047d684=function(e){return Number.isSafeInteger(e)},t.wbg.__wbg_iterator_4068add5b2aef7a6=function(){return Symbol.iterator},t.wbg.__wbg_length_ab6d22b5ead75c72=function(e){return e.length},t.wbg.__wbg_length_f00ec12454a5d9fd=function(e){return e.length},t.wbg.__wbg_msCrypto_a61aeb35a24c1329=function(e){return e.msCrypto},t.wbg.__wbg_new_07b483f72211fd66=function(){return new Object},t.wbg.__wbg_new_58353953ad2097cc=function(){return new Array},t.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},t.wbg.__wbg_new_e52b3efaaa774f96=function(e){return new Uint8Array(e)},t.wbg.__wbg_newnoargs_ff528e72d35de39a=function(e,n){return new Function(w(e,n))},t.wbg.__wbg_newwithbyteoffsetandlength_3b01ecda099177e8=function(e,n,r){return new Uint8Array(e,n>>>0,r>>>0)},t.wbg.__wbg_newwithlength_08f872dc1e3ada2e=function(e){return new Uint8Array(e>>>0)},t.wbg.__wbg_next_8bb824d217961b5d=function(e){return e.next},t.wbg.__wbg_next_e2da48d8fff7439a=function(){return b(function(e){return e.next()},arguments)},t.wbg.__wbg_node_905d3e251edff8a2=function(e){return e.node},t.wbg.__wbg_process_dc0fbacc7c1c06f7=function(e){return e.process},t.wbg.__wbg_randomFillSync_ac0988aba3254290=function(){return b(function(e,n){e.randomFillSync(n)},arguments)},t.wbg.__wbg_require_60cc747a6bc5215a=function(){return b(function(){return module.require},arguments)},t.wbg.__wbg_set_3f1d0b984ed272ed=function(e,n,r){e[n]=r},t.wbg.__wbg_set_7422acbe992d64ab=function(e,n,r){e[n>>>0]=r},t.wbg.__wbg_set_fe4e79d1ed3b0e9b=function(e,n,r){e.set(n,r>>>0)},t.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,n){const r=n.stack,o=A(r,c.__wbindgen_malloc,c.__wbindgen_realloc),_=y;u().setInt32(e+4,_,!0),u().setInt32(e+0,o,!0)},t.wbg.__wbg_static_accessor_GLOBAL_487c52c58d65314d=function(){const e=typeof global>"u"?null:global;return f(e)?0:l(e)},t.wbg.__wbg_static_accessor_GLOBAL_THIS_ee9704f328b6b291=function(){const e=typeof globalThis>"u"?null:globalThis;return f(e)?0:l(e)},t.wbg.__wbg_static_accessor_SELF_78c9e3071b912620=function(){const e=typeof self>"u"?null:self;return f(e)?0:l(e)},t.wbg.__wbg_static_accessor_WINDOW_a093d21393777366=function(){const e=typeof window>"u"?null:window;return f(e)?0:l(e)},t.wbg.__wbg_subarray_dd4ade7d53bd8e26=function(e,n,r){return e.subarray(n>>>0,r>>>0)},t.wbg.__wbg_value_17b896954e14f896=function(e){return e.value},t.wbg.__wbg_versions_c01dfd4722a88165=function(e){return e.versions},t.wbg.__wbindgen_as_number=function(e){return+e},t.wbg.__wbindgen_bigint_from_i64=function(e){return e},t.wbg.__wbindgen_bigint_from_u64=function(e){return BigInt.asUintN(64,e)},t.wbg.__wbindgen_bigint_get_as_i64=function(e,n){const r=n,o=typeof r=="bigint"?r:void 0;u().setBigInt64(e+8,f(o)?BigInt(0):o,!0),u().setInt32(e+0,!f(o),!0)},t.wbg.__wbindgen_boolean_get=function(e){const n=e;return typeof n=="boolean"?n?1:0:2},t.wbg.__wbindgen_debug_string=function(e,n){const r=T(n),o=A(r,c.__wbindgen_malloc,c.__wbindgen_realloc),_=y;u().setInt32(e+4,_,!0),u().setInt32(e+0,o,!0)},t.wbg.__wbindgen_in=function(e,n){return e in n},t.wbg.__wbindgen_init_externref_table=function(){const e=c.__wbindgen_export_2,n=e.grow(4);e.set(0,void 0),e.set(n+0,void 0),e.set(n+1,null),e.set(n+2,!0),e.set(n+3,!1)},t.wbg.__wbindgen_is_bigint=function(e){return typeof e=="bigint"},t.wbg.__wbindgen_is_function=function(e){return typeof e=="function"},t.wbg.__wbindgen_is_object=function(e){const n=e;return typeof n=="object"&&n!==null},t.wbg.__wbindgen_is_string=function(e){return typeof e=="string"},t.wbg.__wbindgen_is_undefined=function(e){return e===void 0},t.wbg.__wbindgen_jsval_eq=function(e,n){return e===n},t.wbg.__wbindgen_jsval_loose_eq=function(e,n){return e==n},t.wbg.__wbindgen_memory=function(){return c.memory},t.wbg.__wbindgen_number_get=function(e,n){const r=n,o=typeof r=="number"?r:void 0;u().setFloat64(e+8,f(o)?0:o,!0),u().setInt32(e+0,!f(o),!0)},t.wbg.__wbindgen_number_new=function(e){return e},t.wbg.__wbindgen_string_get=function(e,n){const r=n,o=typeof r=="string"?r:void 0;var _=f(o)?0:A(o,c.__wbindgen_malloc,c.__wbindgen_realloc),i=y;u().setInt32(e+4,i,!0),u().setInt32(e+0,_,!0)},t.wbg.__wbindgen_string_new=function(e,n){return w(e,n)},t.wbg.__wbindgen_throw=function(e,n){throw new Error(w(e,n))},t}function U(t,e){return c=t.exports,p.__wbindgen_wasm_module=e,g=null,d=null,c.__wbindgen_start(),c}async function p(t){if(c!==void 0)return c;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL("/Honing-Forecast/assets/honing_forecast_bg-DYffyXKn.wasm",self.location.href));const e=L();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:r}=await B(await t,e);return U(n,r)}const F=["Red","Blue","Leaps","Shards","Oreha","Gold","Silver(WIP)"];async function M(t){return await p(),C(t)}async function P(t){try{await p();try{return D(t)}catch(e){console.error("call threw:",e)}}catch(e){console.error("init failed:",e)}}async function k(t){try{await p();try{return O(t)}catch(e){console.error("parser call threw:",e)}}catch(e){console.error("parser init failed:",e)}}async function N(t){try{await p();try{return W(t)}catch(e){console.error("parser unified call threw:",e)}}catch(e){console.error("parser unified init failed:",e)}}self.addEventListener("message",async t=>{const e=t.data;let n=Date.now();const{id:r,payload:o,which_one:_}=e;if(!(_=="CostToChance"||_=="ChanceToCost"||_=="Parser"||_=="ParserUnified"))throw"Invalid operation type"+_;let i;if(_=="CostToChance"){let s=await P(o);i={chance:(s.chance*100).toFixed(2),reasons:s.reasons,hist_counts:s.hist_counts,hist_mins:s.hist_mins,hist_maxs:s.hist_maxs,upgrade_strings:s.upgrade_strings||[],juice_order_armor:s.juice_order_armor||[],juice_order_weapon:s.juice_order_weapon||[],budgets_red_remaining:s.budgets_red_remaining,budgets_blue_remaining:s.budgets_blue_remaining}}else if(_=="ChanceToCost"){const s=F.concat(["Red juice","Blue juice"]);let a=await M(o);const $=a.best_budget;i=Object.fromEntries(s.map((q,v)=>[q,$[v]])),i.actual_prob=a.actual_prob,i.hist_counts=a.hist_counts,i.hist_mins=a.hist_mins,i.hist_maxs=a.hist_maxs}else _=="Parser"?i={upgrades:await k(o)}:_=="ParserUnified"&&(i={upgrades:await N(o)});i.run_time=((Date.now()-n)/1e3).toFixed(2),self.postMessage({type:"result",id:r,result:i})})})();
