(function(){"use strict";let s,d=null;function w(){return(d===null||d.byteLength===0)&&(d=new Uint8Array(s.memory.buffer)),d}let p=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});p.decode();const F=2146435072;let x=0;function j(t,e){return x+=e,x>=F&&(p=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),p.decode(),x=e),p.decode(w().subarray(t,t+e))}function m(t,e){return t=t>>>0,j(t,e)}function W(t){const e=s.__externref_table_alloc();return s.__wbindgen_export_2.set(e,t),e}function A(t,e){try{return t.apply(this,e)}catch(n){const r=W(n);s.__wbindgen_exn_store(r)}}function T(t,e){return t=t>>>0,w().subarray(t/1,t/1+e)}let l=0;const y=new TextEncoder;"encodeInto"in y||(y.encodeInto=function(t,e){const n=y.encode(t);return e.set(n),{read:t.length,written:n.length}});function E(t,e,n){if(n===void 0){const i=y.encode(t),u=e(i.length,1)>>>0;return w().subarray(u,u+i.length).set(i),l=i.length,u}let r=t.length,c=e(r,1)>>>0;const a=w();let o=0;for(;o<r;o++){const i=t.charCodeAt(o);if(i>127)break;a[c+o]=i}if(o!==r){o!==0&&(t=t.slice(o)),c=n(c,r,r=o+t.length*3,1)>>>0;const i=w().subarray(c+o,c+r),u=y.encodeInto(t,i);o+=u.written,c=n(c,r,o,1)>>>0}return l=o,c}let f=null;function _(){return(f===null||f.buffer.detached===!0||f.buffer.detached===void 0&&f.buffer!==s.memory.buffer)&&(f=new DataView(s.memory.buffer)),f}function b(t){return t==null}function C(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const c=t.description;return c==null?"Symbol":`Symbol(${c})`}if(e=="function"){const c=t.name;return typeof c=="string"&&c.length>0?`Function(${c})`:"Function"}if(Array.isArray(t)){const c=t.length;let a="[";c>0&&(a+=C(t[0]));for(let o=1;o<c;o++)a+=", "+C(t[o]);return a+="]",a}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n&&n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function R(t){return s.chance_to_cost_wrapper(t)}function O(t){return s.cost_to_chance_wrapper(t)}function U(t){return s.parser_wrapper_unified(t)}function B(t){return s.average_cost_wrapper(t)}function D(t){return s.cost_to_chance_arr_wrapper(t)}const M=new Set(["basic","cors","default"]);async function v(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.ok&&M.has(t.type)&&t.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function L(){const t={};return t.wbg={},t.wbg.__wbg_Error_e17e777aac105295=function(e,n){return Error(m(e,n))},t.wbg.__wbg_Number_998bea33bd87c3e0=function(e){return Number(e)},t.wbg.__wbg_call_13410aac570ffff7=function(){return A(function(e,n){return e.call(n)},arguments)},t.wbg.__wbg_done_75ed0ee6dd243d9d=function(e){return e.done},t.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,n){let r,c;try{r=e,c=n,console.error(m(e,n))}finally{s.__wbindgen_free(r,c,1)}},t.wbg.__wbg_getRandomValues_3c9c0d586e575a16=function(){return A(function(e,n){globalThis.crypto.getRandomValues(T(e,n))},arguments)},t.wbg.__wbg_get_0da715ceaecea5c8=function(e,n){return e[n>>>0]},t.wbg.__wbg_get_458e874b43b18b25=function(){return A(function(e,n){return Reflect.get(e,n)},arguments)},t.wbg.__wbg_getwithrefkey_1dc361bd10053bfe=function(e,n){return e[n]},t.wbg.__wbg_instanceof_ArrayBuffer_67f3012529f6a2dd=function(e){let n;try{n=e instanceof ArrayBuffer}catch{n=!1}return n},t.wbg.__wbg_instanceof_Uint8Array_9a8378d955933db7=function(e){let n;try{n=e instanceof Uint8Array}catch{n=!1}return n},t.wbg.__wbg_isArray_030cce220591fb41=function(e){return Array.isArray(e)},t.wbg.__wbg_isSafeInteger_1c0d1af5542e102a=function(e){return Number.isSafeInteger(e)},t.wbg.__wbg_iterator_f370b34483c71a1c=function(){return Symbol.iterator},t.wbg.__wbg_length_186546c51cd61acd=function(e){return e.length},t.wbg.__wbg_length_6bb7e81f9d7713e4=function(e){return e.length},t.wbg.__wbg_new_19c25a3f2fa63a02=function(){return new Object},t.wbg.__wbg_new_1f3a344cf3123716=function(){return new Array},t.wbg.__wbg_new_638ebfaedbf32a5e=function(e){return new Uint8Array(e)},t.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},t.wbg.__wbg_next_5b3530e612fde77d=function(e){return e.next},t.wbg.__wbg_next_692e82279131b03c=function(){return A(function(e){return e.next()},arguments)},t.wbg.__wbg_prototypesetcall_3d4a26c1ed734349=function(e,n,r){Uint8Array.prototype.set.call(T(e,n),r)},t.wbg.__wbg_set_3f1d0b984ed272ed=function(e,n,r){e[n]=r},t.wbg.__wbg_set_90f6c0f7bd8c0415=function(e,n,r){e[n>>>0]=r},t.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,n){const r=n.stack,c=E(r,s.__wbindgen_malloc,s.__wbindgen_realloc),a=l;_().setInt32(e+4,a,!0),_().setInt32(e+0,c,!0)},t.wbg.__wbg_value_dd9372230531eade=function(e){return e.value},t.wbg.__wbg_wbindgenbigintgetasi64_ac743ece6ab9bba1=function(e,n){const r=n,c=typeof r=="bigint"?r:void 0;_().setBigInt64(e+8,b(c)?BigInt(0):c,!0),_().setInt32(e+0,!b(c),!0)},t.wbg.__wbg_wbindgenbooleanget_3fe6f642c7d97746=function(e){const n=e,r=typeof n=="boolean"?n:void 0;return b(r)?16777215:r?1:0},t.wbg.__wbg_wbindgendebugstring_99ef257a3ddda34d=function(e,n){const r=C(n),c=E(r,s.__wbindgen_malloc,s.__wbindgen_realloc),a=l;_().setInt32(e+4,a,!0),_().setInt32(e+0,c,!0)},t.wbg.__wbg_wbindgenin_d7a1ee10933d2d55=function(e,n){return e in n},t.wbg.__wbg_wbindgenisbigint_ecb90cc08a5a9154=function(e){return typeof e=="bigint"},t.wbg.__wbg_wbindgenisfunction_8cee7dce3725ae74=function(e){return typeof e=="function"},t.wbg.__wbg_wbindgenisobject_307a53c6bd97fbf8=function(e){const n=e;return typeof n=="object"&&n!==null},t.wbg.__wbg_wbindgenisundefined_c4b71d073b92f3c5=function(e){return e===void 0},t.wbg.__wbg_wbindgenjsvaleq_e6f2ad59ccae1b58=function(e,n){return e===n},t.wbg.__wbg_wbindgenjsvallooseeq_9bec8c9be826bed1=function(e,n){return e==n},t.wbg.__wbg_wbindgennumberget_f74b4c7525ac05cb=function(e,n){const r=n,c=typeof r=="number"?r:void 0;_().setFloat64(e+8,b(c)?0:c,!0),_().setInt32(e+0,!b(c),!0)},t.wbg.__wbg_wbindgenstringget_0f16a6ddddef376f=function(e,n){const r=n,c=typeof r=="string"?r:void 0;var a=b(c)?0:E(c,s.__wbindgen_malloc,s.__wbindgen_realloc),o=l;_().setInt32(e+4,o,!0),_().setInt32(e+0,a,!0)},t.wbg.__wbg_wbindgenthrow_451ec1a8469d7eb6=function(e,n){throw new Error(m(e,n))},t.wbg.__wbindgen_cast_2241b6af4c4b2941=function(e,n){return m(e,n)},t.wbg.__wbindgen_cast_4625c577ab2ec9ee=function(e){return BigInt.asUintN(64,e)},t.wbg.__wbindgen_cast_9ae0607507abb057=function(e){return e},t.wbg.__wbindgen_cast_d6cd19b81560fd6e=function(e){return e},t.wbg.__wbindgen_init_externref_table=function(){const e=s.__wbindgen_export_2,n=e.grow(4);e.set(0,void 0),e.set(n+0,void 0),e.set(n+1,null),e.set(n+2,!0),e.set(n+3,!1)},t}function k(t,e){return s=t.exports,g.__wbindgen_wasm_module=e,f=null,d=null,s.__wbindgen_start(),s}async function g(t){if(s!==void 0)return s;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL("/Honing-Forecast/assets/honing_forecast_bg-2_h0zXB7.wasm",self.location.href));const e=L();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:r}=await v(await t,e);return k(n,r)}const N=["Red","Blue","Leaps","Shards","Oreha","Gold","Silver"];async function $(t){return await g(),R(t)}async function P(t){try{await g();try{return O(t)}catch(e){console.error("call threw:",e)}}catch(e){console.error("init failed:",e)}}async function V(t){try{await g();try{return D(t)}catch(e){console.error("cost_to_chance_arr call threw:",e)}}catch(e){console.error("cost_to_chance_arr init failed:",e)}}async function q(t){try{await g();try{return U(t)}catch(e){console.error("parser unified call threw:",e)}}catch(e){console.error("parser unified init failed:",e)}}async function z(t){try{await g();try{return B(t)}catch(e){console.error("average cost call threw:",e)}}catch(e){console.error("average cost init failed:",e)}}self.addEventListener("message",async t=>{const e=t.data;let n=Date.now();const{id:r,payload:c,which_one:a}=e;if(!(a=="CostToChance"||a=="CostToChanceArr"||a=="ChanceToCost"||a=="ParserUnified"||a=="AverageCost"))throw"Invalid operation type"+a;let o;if(a=="CostToChance"){let i=await P(c);const u=i.reasons.map((S,h)=>`${(S*100).toFixed(2)}% chance to have enough ${N[h]}`);o={chance:(i.chance*100).toFixed(2),reasons:u,hist_counts:i.hist_counts,hist_mins:i.hist_mins,hist_maxs:i.hist_maxs,upgrade_strings:i.upgrade_strings||[],juice_strings_armor:i.juice_strings_armor||[],juice_strings_weapon:i.juice_strings_weapon||[],budgets_red_remaining:i.budgets_red_remaining,budgets_blue_remaining:i.budgets_blue_remaining}}else if(a=="CostToChanceArr"){let i=await V(c);const u=i.final_chances.map(h=>(h*100).toFixed(2)),S=i.typed_fail_counters.map(h=>h.map((I,X)=>I/(i.final_chances.length>0?1e5:1)));o={final_chances:u,failure_rates_arr:S,budgets_red_remaining:i.budgets_red_remaining,budgets_blue_remaining:i.budgets_blue_remaining}}else if(a=="ChanceToCost"){let i=await $(c);o={hundred_budgets:i.hundred_budgets,hundred_chances:i.hundred_chances,hist_counts:i.hist_counts,hist_mins:i.hist_mins,hist_maxs:i.hist_maxs}}else if(a=="ParserUnified"){let i=await q(c);o={upgrades:i[0],unlocks:i[1],other_strategy_prob_dists:i[2]}}else a=="AverageCost"&&(o={average_costs:await z(c)});o.run_time=((Date.now()-n)/1e3).toFixed(2),self.postMessage({type:"result",id:r,result:o})})})();
//# sourceMappingURL=js_to_wasm-4_PvOiBx.js.map
