import{r as e,j as a}from"./vendor-mui-BPgiYWtU.js";import{a as Ct}from"./vendor-react-CC_ZIGTP.js";import{d as xt,T as xe,f as _t,B as _e,I as Ie,s as Te,h as Tt}from"./chance-to-cost-DKk9rqNy.js";import{d as Rt,t as ce,w as bt,e as Mt,b as At,f as Et,h as jt,G as Lt,S as Pt,i as Ot,m as Be,j as Ge}from"./utils-BdNnqXCI.js";import{N as Nt,A as kt,C as It,c as Bt,a as Gt,b as zt}from"./control-panel-4DbgvF8Y.js";import{C as Dt}from"./cost-to-chance-Dd0b0Cv0.js";import{G as qt}from"./gamba-B7trnSaU.js";import{I as Xt}from"./components-ClshZPYI.js";import"./vendor-emotion-DUBDgfkx.js";import"./wasm-workers-CSWhRIRv.js";import"./vendor-visx-DTrp-NVr.js";(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))w(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const p of c.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&w(p)}).observe(document,{childList:!0,subtree:!0});function m(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function w(o){if(o.ep)return;o.ep=!0;const c=m(o);fetch(o.href,c)}})();var ie={},ze;function Ht(){if(ze)return ie;ze=1;var i=Ct();return ie.createRoot=i.createRoot,ie.hydrateRoot=i.hydrateRoot,ie}var Kt=Ht();function Ut(){const[i,f]=e.useState(()=>Array.from({length:xt},()=>Array.from({length:xe},()=>!1))),[m,w]=e.useState(()=>Array.from({length:_t},()=>Array(_e).fill(!1))),[o,c]=e.useState(()=>Object.fromEntries(Ie.map(t=>[t,"0"]))),[p,ue]=e.useState(!0),[M,K]=e.useState(()=>Object.fromEntries(Ie.slice(0,7).map(t=>t=="Gold"?[t,"1"]:[t,"0"]))),[A,v]=e.useState(()=>"50"),[Re,N]=e.useState(()=>"50"),[E,le]=e.useState(()=>"No juice"),[j,de]=e.useState(()=>!0),[U,De]=e.useState(()=>"100"),[fe,k]=e.useState(()=>Array.from({length:xe},()=>!1)),[me,B]=e.useState(()=>Array.from({length:_e},()=>!1)),[I,pe]=e.useState(!1),[L,ge]=e.useState(()=>"100000"),[P,qe]=e.useState("chance-to-cost"),[he,be]=e.useState(1),[Xe,Me]=e.useState(1),[W,Ae]=e.useState(!1),[we,ye]=e.useState(null),[ve,Se]=e.useState(null),[He,Ee]=e.useState(!1),[S,Ce]=e.useState(!0),[g,G]=e.useState(()=>Array.from({length:2},()=>Array(xe).fill(0))),[h,z]=e.useState(()=>Array.from({length:2},()=>Array(_e).fill(0))),D=e.useRef(null),q=e.useRef(null),Ke=e.useRef(null),[d,F]=e.useState({active:!1,grid:null,startR:0,startC:0,endR:0,endC:0,startClientX:0,startClientY:0,endClientX:0,endClientY:0,initialState:!1}),[X,je]=e.useState(null),y=e.useRef(d);e.useEffect(()=>{y.current=d},[d]);const[Ue,We]=e.useState({visible:!1,type:null,x:0,y:0,content:null,upgradeData:null}),Fe=Ot(We);e.useEffect(()=>{try{Rt(f,w,le,de,k,B,v,c,ue,K,pe,ge,Ce,G,z)}catch{}},[]),e.useEffect(()=>{N(A)},[A]),e.useEffect(()=>{const t=ce(i);G(t)},[i]),e.useEffect(()=>{const t=ce(m);z(t)},[m]),e.useEffect(()=>{const t=()=>{const s=window.innerWidth;if(s<1200){const r=Math.max(0,s/1200);be(r)}else be(1)};return t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[]),e.useEffect(()=>{let t=window.devicePixelRatio;const s=()=>{const r=window.devicePixelRatio;if(r!==t){t=r;const n=1/r;Me(n)}};return Me(1/window.devicePixelRatio),window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[]);const C=e.useRef(null);e.useEffect(()=>(C.current&&(window.clearTimeout(C.current),C.current=null),C.current=window.setTimeout(()=>{try{bt(i,m,E,j,fe,me,A,o,p,M,I,L,S,g,h)}catch{}C.current=null},250),()=>{C.current&&(window.clearTimeout(C.current),C.current=null)}),[i,m,E,j,fe,me,A,o,p,M,I,L,S,g,h]);const Le=Lt({topGridRef:D,bottomGridRef:q,marqueeRef:y,topGrid:i,bottomGrid:m,setMarquee:F});e.useEffect(()=>{const t=function(n){Be(n,y,D,q,F)},s=(n,u)=>{const l=n.touches[0]||n.changedTouches[0];return{...n,type:u,clientX:l.clientX,clientY:l.clientY,button:0,buttons:1,preventDefault:n.preventDefault.bind(n),stopPropagation:n.stopPropagation.bind(n)}},r=n=>{if(y.current&&y.current.active){n.preventDefault();const u=s(n,"mousemove");Be(u,y,D,q,F)}};return window.addEventListener("mousemove",t),window.addEventListener("touchmove",r,{passive:!1}),()=>{window.removeEventListener("mousemove",t),window.removeEventListener("touchmove",r)}},[]),e.useEffect(()=>{const t=Mt({marqueeRef:y,topGridRef:D,bottomGridRef:q,setTopGrid:f,setBottomGrid:w,set_prev_checked_arr:k,set_prev_checked_arr_bottom:B,setMarquee:F}),s=(n,u)=>{const l=n.touches[0]||n.changedTouches[0];return{...n,type:u,clientX:l.clientX,clientY:l.clientY,button:0,buttons:0,preventDefault:n.preventDefault.bind(n),stopPropagation:n.stopPropagation.bind(n)}},r=n=>{if(y.current&&y.current.active){n.preventDefault();const u=s(n,"mouseup");t(u)}};return window.addEventListener("mouseup",t),window.addEventListener("touchend",r,{passive:!1}),()=>{window.removeEventListener("mouseup",t),window.removeEventListener("touchend",r)}},[]),e.useEffect(()=>{if(!d.active||!d.grid){je(null);return}const t=d.startClientX,s=d.startClientY,r=d.endClientX,n=d.endClientY,u=Math.min(t,r),l=Math.min(s,n),H=Math.abs(r-t),St=Math.abs(n-s);je({left:u,top:l,width:H,height:St})},[d]);const Ye=t=>{N(t);const s=t.replace(/[^0-9]/g,""),r=parseInt(s);s===t&&!isNaN(r)&&r>=0&&r<=100&&v(s)},Ve=()=>{const t=Re.replace(/[^0-9]/g,""),s=parseInt(t);t===""||isNaN(s)?N(A):s>100?(v("100"),N("100")):s<0?(v("0"),N("0")):(v(t),N(t))},Je=t=>le(t),Ze=()=>{Ae(t=>{const s=!t;if(t)ye(null),Se(null);else{const r=(x==null?void 0:x.hist_mins)||(O==null?void 0:O.hist_mins)||null,n=(x==null?void 0:x.hist_maxs)||(O==null?void 0:O.hist_maxs)||null;ye(r?r.slice():null),Se(n?n.slice():null)}return s})},Pe=(t,s,r,n)=>{t==="top"?G(u=>{const l=u.map(H=>[...H]);return l[s===4?0:1][r]=n,l}):z(u=>{const l=u.map(H=>[...H]);return l[s===4?0:1][r]=n,l})},$e=t=>{if(t!==S)if(t){const s=Ge(g),r=Ge(h);f(s),w(r)}else{const s=ce(i),r=ce(m);G(s),z(r)}Ce(t)},Qe=Bt({setTopGrid:f,setBottomGrid:w,set_prev_checked_arr:k,set_prev_checked_arr_bottom:B,set_budget_inputs:c,setUserMatsValue:K,set_desired_chance:v,set_adv_hone_strategy_change:le,set_express_event:de,setAutoOptimization:ue,_setBucketCount:De,setCumulativeGraph:pe,setDataSize:ge,setLockXAxis:Ae,setLockedMins:ye,setLockedMaxs:Se,setShowAverage:Ee,setUseGridInput:Ce,setNormalCounts:G,setAdvCounts:z}),et=Gt({setTopGrid:f,setBottomGrid:w,set_desired_chance:v,set_prev_checked_arr:k,set_prev_checked_arr_bottom:B}),tt=zt({setTopGrid:f,setBottomGrid:w,set_budget_inputs:c,set_desired_chance:v,set_prev_checked_arr:k}),[Oe,nt]=e.useState(null),[st,rt]=e.useState(null),[Ne,ot]=e.useState(!1),[at,ct]=e.useState(!1),[it,ke]=e.useState(null),[ut,lt]=e.useState([]),[dt,ft]=e.useState(!1),[mt,pt]=e.useState(!1),[x,gt]=e.useState(null),[O,ht]=e.useState(null),Y=e.useRef(null),V=e.useRef(null),J=e.useRef(null),Z=e.useRef(null),_=e.useRef(null),T=e.useRef(null),R=e.useRef(null),b=e.useRef(null),$=()=>At({topGrid:i,bottomGrid:m,budget_inputs:o,adv_hone_strategy:E,express_event:j,bucketCount:U,autoOptimization:p,userMatsValue:M,dataSize:L,useGridInput:S,normalCounts:g,advCounts:h}),Q=Et({costWorkerRef:Y,chanceWorkerRef:V,averageCostWorkerRef:J,parserWorkerRef:Z,setCostToChanceBusy:ot,setChanceToCostBusy:ct,setAverageCostBusy:ft,setParserBusy:pt,set_chance_result:nt,set_cost_result:rt,setAverageCosts:ke,setUpgradeArr:lt,setCachedChanceGraphData:gt,setCachedCostGraphData:ht}),wt=e.useMemo(()=>JSON.stringify(o),[o]),ee=e.useMemo(()=>String(E),[E]),te=e.useMemo(()=>String(j),[j]),ne=e.useMemo(()=>String(U),[U]),yt=e.useMemo(()=>String(p),[p]),vt=e.useMemo(()=>JSON.stringify(M),[M]),se=e.useMemo(()=>String(L),[L]),re=e.useMemo(()=>JSON.stringify(g),[g]),oe=e.useMemo(()=>JSON.stringify(h),[h]);e.useEffect(()=>{_.current&&(window.clearTimeout(_.current),_.current=null),_.current=window.setTimeout(()=>{const t=$();Q("CostToChance",t),_.current=null},100)},[wt,ee,te,ne,yt,vt,se,re,oe]),e.useEffect(()=>{T.current&&(window.clearTimeout(T.current),T.current=null),T.current=window.setTimeout(()=>{const t=$();Q("ChanceToCost",t),T.current=null},100)},[ee,te,ne,se,re,oe]),e.useEffect(()=>{R.current&&(window.clearTimeout(R.current),R.current=null),R.current=window.setTimeout(()=>{if(ae){const t=$();Q("AverageCost",t)}else ke(null);R.current=null},100)},[ee,te,ne,se,re,oe]),e.useEffect(()=>{b.current&&(window.clearTimeout(b.current),b.current=null),b.current=window.setTimeout(()=>{const t=$();Q("ParserUnified",t),b.current=null},100)},[ee,te,ne,se,re,oe]),e.useEffect(()=>()=>{if(Y.current){try{Y.current.terminate()}catch{}Y.current=null}if(V.current){try{V.current.terminate()}catch{}V.current=null}if(J.current){try{J.current.terminate()}catch{}J.current=null}if(Z.current){try{Z.current.terminate()}catch{}Z.current=null}_.current&&(window.clearTimeout(_.current),_.current=null),T.current&&(window.clearTimeout(T.current),T.current=null),R.current&&(window.clearTimeout(R.current),R.current=null),b.current&&(window.clearTimeout(b.current),b.current=null)},[]);const ae=e.useMemo(()=>g[0].some(t=>t>0)||g[1].some(t=>t>0)||h[0].some(t=>t>0)||h[1].some(t=>t>0),[g,h]);return a.jsxs("div",{style:Te.pageContainer,children:[X?a.jsx("div",{style:{position:"fixed",left:X.left,top:X.top,width:X.width,height:X.height,background:"var(--marquee-bg)",border:"2px solid var(--marquee-border)",pointerEvents:"none",zIndex:9999}}):null,jt(Ue,he,Xe),a.jsxs("div",{ref:Ke,style:{...Te.mainContainer,transform:`scale(${he})`,transformOrigin:"top center"},children:[a.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:6},children:[a.jsx(Xt,{iconName:"Forecast Icon",size:64,style:{display:"flex",alignItems:"center",gap:"12px"},display_text:""}),a.jsx("h1",{style:Te.heading,children:"Honing Forecast"})]}),a.jsxs("div",{style:{display:"flex",gap:"var(--spacing-2xl)",alignItems:"flex-start",flexWrap:"wrap",justifyContent:"flex-start"},children:[a.jsx(Nt,{topGrid:i,setTopGrid:f,prev_checked_arr:fe,set_prev_checked_arr:k,topGridRef:D,marquee:d,onGridMouseDown:Le,useGridInput:S,normalCounts:g,onNumericInputChange:Pe}),a.jsx(kt,{bottomGrid:m,setBottomGrid:w,prev_checked_arr_bottom:me,set_prev_checked_arr_bottom:B,bottomGridRef:q,marquee:d,onGridMouseDown:Le,adv_hone_strategy:E,adv_hone_strategy_change:Je,useGridInput:S,advCounts:h,onNumericInputChange:Pe}),a.jsx(It,{controlsLeft:null,mainScale:he,fillDemo:tt,fillRandom:et,clearAll:Qe,express_event:j,set_express_event:de,cumulativeGraph:I,setCumulativeGraph:pe,dataSize:L,setDataSize:ge,lockXAxis:W,onToggleLockXAxis:Ze,useGridInput:S,setUseGridInput:$e})]}),a.jsx(Pt,{activePage:P,onPageChange:qe}),a.jsx("div",{className:P==="chance-to-cost"?"page":"page page--hidden","aria-hidden":P!=="chance-to-cost",children:a.jsx(Tt,{desired_chance:A,uncleaned_desired_chance:Re,onDesiredChange:Ye,onDesiredBlur:Ve,cost_result:st,cachedCostGraphData:O,AnythingTicked:ae,ChanceToCostBusy:at,cumulativeGraph:I,lockXAxis:W,lockedMins:we,lockedMaxs:ve,showAverage:He,setShowAverage:Ee,averageCosts:it,AverageCostBusy:dt})}),a.jsx("div",{className:P==="cost-to-chance"?"page":"page page--hidden","aria-hidden":P!=="cost-to-chance",children:a.jsx(Dt,{budget_inputs:o,set_budget_inputs:c,userMatsValue:M,setUserMatsValue:K,autoOptimization:p,setAutoOptimization:ue,chance_result:Oe,cachedChanceGraphData:x,AnythingTicked:ae,CostToChanceBusy:Ne,cumulativeGraph:I,lockXAxis:W,lockedMins:we,lockedMaxs:ve})}),a.jsx("div",{className:P==="gamba"?"page":"page page--hidden","aria-hidden":P!=="gamba",children:a.jsx(qt,{budget_inputs:o,set_budget_inputs:c,userMatsValue:M,setUserMatsValue:K,topGrid:i,bottomGrid:m,adv_hone_strategy:E,express_event:j,desired_chance:A,bucketCount:U,autoOptimization:p,dataSize:L,tooltipHandlers:Fe,chance_result:Oe,cachedChanceGraphData:x,AnythingTicked:ae,CostToChanceBusy:Ne,cumulativeGraph:I,lockXAxis:W,lockedMins:we,lockedMaxs:ve,useGridInput:S,normalCounts:g,advCounts:h,upgradeArr:ut,ParserBusy:mt})})]})]})}function Wt(){return a.jsx(Ut,{})}function Ft(){return a.jsx(Wt,{})}Kt.createRoot(document.getElementById("root")).render(a.jsx(e.StrictMode,{children:a.jsx(Ft,{})}));
//# sourceMappingURL=index-BfOpK-GZ.js.map
